# 游戏字幕朗读工具 (ScreenScanner)

一个为儿童设计的游戏字幕实时朗读工具，通过屏幕截图识别游戏对话内容并语音朗读，帮助识字阶段的孩子理解游戏剧情。

## 功能特点

- **智能识别**：使用阿里云 Qwen3-Omni 全模态 AI 自动提取游戏画面中的对话内容
- **语音朗读**：采用儿童友好的 Cherry 音色，清晰朗读角色对话
- **悬浮窗模式**：轻量级悬浮按钮，不遮挡游戏画面
- **全局快捷键**：支持 F9 快捷键触发（游戏全屏时也可用）
- **灵活配置**：可自定义音色、提示词等参数
- **实时反馈**：显示识别到的文本和处理状态

## 安装步骤

### 1. 克隆项目

```bash
git clone <repository-url>
cd ScreenScanner
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 配置 API Key

在项目根目录创建 `.env` 文件，添加阿里云 API Key：

```
DASHSCOPE_API_KEY=your_api_key_here
```

获取 API Key：访问 [阿里云 DashScope](https://dashscope.console.aliyun.com/) 注册并获取

## 使用方法

### 启动应用

```bash
python game_subtitle_reader.py
```

### 两种使用模式

#### 1. 主窗口模式
- 点击"截取屏幕"按钮触发识别
- 在主窗口查看识别结果和配置选项

#### 2. 悬浮窗模式（推荐）
- 点击"切换悬浮窗模式"进入悬浮模式
- 小窗口可拖动到任意位置
- 拖动：鼠标按住标题栏（⋮⋮ 字幕朗读 ⋮⋮）移动
- 触发识别：点击悬浮按钮或按 F9 快捷键

### 操作流程

1. 打开游戏并进入有对话的场景
2. 启动朗读工具，切换到悬浮窗模式
3. 当游戏出现对话时，点击悬浮按钮或按 F9
4. 等待 AI 识别并语音朗读对话内容

## 配置说明

### 音色选择

可在主窗口选择不同音色：
- **Cherry**（推荐）：儿童友好，清晰柔和
- **Chelsie**：女声，成熟稳重
- **Stella**：女声，活泼明快
- **Luna**：女声，温柔亲切

### 提示词自定义

默认提示词：
```
请帮我提取画面中角色的对话内容，并以"角色名说：对话内容"的格式输出。
如果画面中没有对话，请回复"未检测到对话"。
```

可根据需要修改提示词以优化识别效果。

## 技术栈

- **AI 模型**：阿里云 Qwen3-Omni Flash（全模态大模型）
- **图像处理**：Pillow、MSS（高性能截图）
- **音频播放**：PyAudio、NumPy、SoundFile
- **界面框架**：Tkinter
- **全局快捷键**：pynput
- **API 通信**：OpenAI SDK（兼容模式）

## 项目结构

```
ScreenScanner/
├── game_subtitle_reader.py    # 主程序
├── config.py                   # 配置管理
├── requirements.txt            # 依赖列表
├── qwen_omini_api.py          # API 使用示例
├── .env                        # API Key 配置（需自行创建）
└── README.md                   # 项目说明
```

## 常见问题

### 1. 识别不准确怎么办？

- 确保游戏对话文字清晰可见
- 避免截图包含过多无关内容
- 可尝试调整提示词增加识别精度

### 2. 快捷键不生效？

- 确认应用正在运行且未最小化到托盘
- 检查是否与其他软件快捷键冲突
- 尝试以管理员权限运行（部分游戏需要）

### 3. API 调用失败？

- 检查 `.env` 文件中 API Key 是否正确
- 确认网络连接正常
- 查看阿里云账户余额是否充足

## 注意事项

- 本工具需要联网使用（调用云端 API）
- API 调用会产生费用，请注意控制使用频率
- 仅供个人学习和家庭使用，请勿用于商业用途

## 许可证

MIT License

## 反馈与贡献

如有问题或建议，欢迎提交 Issue 或 Pull Request。
